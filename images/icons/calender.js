!function(factory){"function"==typeof define&&define.amd?define(["jquery"],factory):factory(jQuery)}(function(jQuery){"use strict";var $=jQuery;$=jQuery;if(void 0===jQuery)throw new Error("Metro 4 requires jQuery!");if("MutationObserver"in window==!1)throw new Error("Metro 4 requires MutationObserver!");var meta_init=$("meta[name='metro4:init']").attr("content"),meta_locale=$("meta[name='metro4:locale']").attr("content"),meta_week_start=$("meta[name='metro4:week_start']").attr("content"),meta_date_format=$("meta[name='metro4:date_format']").attr("content"),meta_date_format_input=$("meta[name='metro4:date_format_input']").attr("content"),meta_animation_duration=$("meta[name='metro4:animation_duration']").attr("content"),meta_callback_timeout=$("meta[name='metro4:callback_timeout']").attr("content"),meta_timeout=$("meta[name='metro4:timeout']").attr("content"),meta_scroll_multiple=$("meta[name='metro4:scroll_multiple']").attr("content"),meta_cloak=$("meta[name='metro4:cloak']").attr("content"),meta_cloak_duration=$("meta[name='metro4:cloak_duration']").attr("content"),meta_about=$("meta[name='metro4:about']").attr("content");void 0===window.METRO_SHOW_ABOUT&&(window.METRO_SHOW_ABOUT=void 0===meta_about||JSON.parse(meta_about));var meta_compile=$("meta[name='metro4:compile']").attr("content");void 0===window.METRO_SHOW_COMPILE_TIME&&(window.METRO_SHOW_COMPILE_TIME=void 0===meta_compile||JSON.parse(meta_compile)),void 0===window.METRO_INIT&&(window.METRO_INIT=void 0===meta_init||JSON.parse(meta_init)),void 0===window.METRO_DEBUG&&(window.METRO_DEBUG=!0),void 0===window.METRO_WEEK_START&&(window.METRO_WEEK_START=void 0!==meta_week_start?parseInt(meta_week_start):0),void 0===window.METRO_DATE_FORMAT&&(window.METRO_DATE_FORMAT=void 0!==meta_date_format?meta_date_format:"%Y-%m-%d"),void 0===window.METRO_DATE_FORMAT_INPUT&&(window.METRO_DATE_FORMAT_INPUT=void 0!==meta_date_format_input?meta_date_format_input:"%Y-%m-%d"),void 0===window.METRO_LOCALE&&(window.METRO_LOCALE=void 0!==meta_locale?meta_locale:"en-US"),void 0===window.METRO_ANIMATION_DURATION&&(window.METRO_ANIMATION_DURATION=void 0!==meta_animation_duration?parseInt(meta_animation_duration):300),void 0===window.METRO_CALLBACK_TIMEOUT&&(window.METRO_CALLBACK_TIMEOUT=void 0!==meta_callback_timeout?parseInt(meta_callback_timeout):500),void 0===window.METRO_TIMEOUT&&(window.METRO_TIMEOUT=void 0!==meta_timeout?parseInt(meta_timeout):2e3),void 0===window.METRO_SCROLL_MULTIPLE&&(window.METRO_SCROLL_MULTIPLE=void 0!==meta_scroll_multiple?parseInt(meta_scroll_multiple):20),void 0===window.METRO_CLOAK_REMOVE&&(window.METRO_CLOAK_REMOVE=void 0!==meta_cloak?(""+meta_cloak).toLowerCase():"fade"),void 0===window.METRO_CLOAK_DURATION&&(window.METRO_CLOAK_DURATION=void 0!==meta_cloak_duration?parseInt(meta_cloak_duration):500),void 0===window.METRO_HOTKEYS_FILTER_CONTENT_EDITABLE&&(window.METRO_HOTKEYS_FILTER_CONTENT_EDITABLE=!0),void 0===window.METRO_HOTKEYS_FILTER_INPUT_ACCEPTING_ELEMENTS&&(window.METRO_HOTKEYS_FILTER_INPUT_ACCEPTING_ELEMENTS=!0),void 0===window.METRO_HOTKEYS_FILTER_TEXT_INPUTS&&(window.METRO_HOTKEYS_FILTER_TEXT_INPUTS=!0),void 0===window.METRO_HOTKEYS_BUBBLE_UP&&(window.METRO_HOTKEYS_BUBBLE_UP=!1),void 0===window.METRO_THROWS&&(window.METRO_THROWS=!0),window.METRO_MEDIA=[],"function"!=typeof Object.create&&(Object.create=function(o){function F(){}return F.prototype=o,new F}),"function"!=typeof Object.values&&(Object.values=function(obj){return Object.keys(obj).map(function(e){return obj[e]})}),"function"!=typeof window.setImmediate&&(window.setImmediate=function(fn){return setTimeout(fn,0)});var isTouch="ontouchstart"in window||0<navigator.MaxTouchPoints||0<navigator.msMaxTouchPoints,Metro={version:"4.2.48",compileTime:"@@compile",buildNumber:"734",isTouchable:isTouch,fullScreenEnabled:document.fullscreenEnabled,sheet:null,controlsPosition:{INSIDE:"inside",OUTSIDE:"outside"},groupMode:{ONE:"one",MULTI:"multi"},aspectRatio:{HD:"hd",SD:"sd",CINEMA:"cinema"},fullScreenMode:{WINDOW:"window",DESKTOP:"desktop"},position:{TOP:"top",BOTTOM:"bottom",LEFT:"left",RIGHT:"right",TOP_RIGHT:"top-right",TOP_LEFT:"top-left",BOTTOM_LEFT:"bottom-left",BOTTOM_RIGHT:"bottom-right",LEFT_BOTTOM:"left-bottom",LEFT_TOP:"left-top",RIGHT_TOP:"right-top",RIGHT_BOTTOM:"right-bottom"},popoverEvents:{CLICK:"click",HOVER:"hover",FOCUS:"focus"},stepperView:{SQUARE:"square",CYCLE:"cycle",DIAMOND:"diamond"},listView:{LIST:"list",CONTENT:"content",ICONS:"icons",ICONS_MEDIUM:"icons-medium",ICONS_LARGE:"icons-large",TILES:"tiles",TABLE:"table"},events:{click:"click.metro",start:isTouch?"touchstart.metro":"mousedown.metro",stop:isTouch?"touchend.metro":"mouseup.metro",move:isTouch?"touchmove.metro":"mousemove.metro",enter:isTouch?"touchstart.metro":"mouseenter.metro",startAll:"mousedown.metro touchstart.metro",stopAll:"mouseup.metro touchend.metro",moveAll:"mousemove.metro touchmove.metro",leave:"mouseleave.metro",focus:"focus.metro",blur:"blur.metro",resize:"resize.metro",keyup:"keyup.metro",keydown:"keydown.metro",keypress:"keypress.metro",dblclick:"dblclick.metro",input:"input.metro",change:"change.metro",cut:"cut.metro",paste:"paste.metro",scroll:"scroll.metro",mousewheel:"mousewheel.metro",inputchange:"change.metro input.metro propertychange.metro cut.metro paste.metro copy.metro",dragstart:"dragstart.metro",dragend:"dragend.metro",dragenter:"dragenter.metro",dragover:"dragover.metro",dragleave:"dragleave.metro",drop:"drop.metro",drag:"drag.metro"},keyCode:{BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,BREAK:19,CAPS:20,ESCAPE:27,SPACE:32,PAGEUP:33,PAGEDOWN:34,END:35,HOME:36,LEFT_ARROW:37,UP_ARROW:38,RIGHT_ARROW:39,DOWN_ARROW:40,COMMA:188},media_queries:{FS:"(min-width: 0px)",XS:"(min-width: 360px)",SM:"(min-width: 576px)",MD:"(min-width: 768px)",LG:"(min-width: 992px)",XL:"(min-width: 1200px)",XXL:"(min-width: 1452px)"},media_sizes:{FS:0,XS:360,SM:576,LD:640,MD:768,LG:992,XL:1200,XXL:1452},media_mode:{FS:"fs",XS:"xs",SM:"sm",MD:"md",LG:"lg",XL:"xl",XXL:"xxl"},media_modes:["fs","xs","sm","md","lg","xl","xxl"],actions:{REMOVE:1,HIDE:2},hotkeys:{},about:function(){console.log("Metro 4 - v"+Metro.version+". "+Metro.showCompileTime())},showCompileTime:function(){return"Built at: "+Metro.compileTime},aboutDlg:function(){alert("Metro 4 - v"+Metro.version+". "+Metro.showCompileTime())},ver:function(){return Metro.version},build:function(){return Metro.build},compile:function(){return Metro.compileTime},observe:function(){new MutationObserver(function(mutations){mutations.map(function(mutation){if("attributes"===mutation.type&&"data-role"!==mutation.attributeName)if("data-hotkey"===mutation.attributeName)Metro.initHotkeys([mutation.target],!0);else{var element=$(mutation.target),mc=element.data("metroComponent");void 0!==mc&&$.each(mc,function(){var plug=element.data(this);plug&&plug.changeAttribute(mutation.attributeName)})}else if("childList"===mutation.type&&0<mutation.addedNodes.length){var i,$node,node,widgets=[],nodes=mutation.addedNodes;if(nodes.length){for(i=0;i<nodes.length;i++)node=nodes[i],void 0!==($node=$(node)).attr("data-role")&&widgets.push(node),$.each($node.find("[data-role]"),function(){-1===widgets.indexOf(this)&&widgets.push(this)});widgets.length&&Metro.initWidgets(widgets,"observe")}}})}).observe($("html")[0],{childList:!0,attributes:!0,subtree:!0})},init:function(){var widgets=$("[data-role]"),hotkeys=$("[data-hotkey]"),html=$("html");return!0===isTouch?html.addClass("metro-touch-device"):html.addClass("metro-no-touch-device"),Metro.sheet=Utils.newCssSheet(),window.METRO_MEDIA=[],$.each(Metro.media_queries,function(key,query){Utils.media(query)&&METRO_MEDIA.push(Metro.media_mode[key])}),Metro.observe(),Metro.initHotkeys(hotkeys),Metro.initWidgets(widgets,"init"),METRO_SHOW_ABOUT&&Metro.about(!0),"fade"!==METRO_CLOAK_REMOVE?$(".m4-cloak").removeClass("m4-cloak"):$(".m4-cloak").animate({opacity:1},METRO_CLOAK_REMOVE,function(){$(".m4-cloak").removeClass("m4-cloak")}),Metro},initHotkeys:function(hotkeys,redefine){$.each(hotkeys,function(){var element=$(this),hotkey=!!element.attr("data-hotkey")&&element.attr("data-hotkey").toLowerCase(),fn=!!element.attr("data-hotkey-func")&&element.attr("data-hotkey-func");!1!==hotkey&&(!0!==element.data("hotKeyBonded")||Utils.bool(redefine))&&(Metro.hotkeys[hotkey]=[this,fn],element.data("hotKeyBonded",!0))})},initWidgets:function(widgets){$.each(widgets,function(){var $this=$(this);$this.data("role").split(/\s*,\s*/).map(function(func){if(void 0!==$.fn[func]&&void 0===$this.attr("data-role-"+func))try{$.fn[func].call($this),$this.attr("data-role-"+func,!0);var mc=$this.data("metroComponent");void 0===mc?mc=[func]:mc.push(func),$this.data("metroComponent",mc)}catch(e){throw console.log(e.message+" in "+e.stack),e}})})},plugin:function(name,object){$.fn[name]=function(options){return this.each(function(){$.data(this,name,Object.create(object).init(options,this))})}},destroyPlugin:function(element,name){var p,mc,el=$(element);if(p=el.data(name),!Utils.isValue(p))throw new Error("Component can not be destroyed: the element is not a Metro 4 component.");if(!Utils.isFunc(p.destroy))throw new Error("Component can not be destroyed: method destroy not found.");p.destroy(),mc=el.data("metroComponent"),Utils.arrayDelete(mc,name),el.data("metroComponent",mc),$.removeData(el[0],name),el.removeAttr("data-role-"+name)},destroyPluginAll:function(element){var el=$(element),mc=el.data("metroComponent");void 0!==mc&&0<mc.length&&$.each(mc,function(){Metro.destroyPlugin(el[0],this)})},initPlugin:function(element,name){element=$(element);try{if(void 0!==$.fn[name]&&void 0===element.attr("data-role-"+name)){$.fn[name].call(element),element.attr("data-role-"+name,!0);var mc=element.data("metroComponent");void 0===mc?mc=[name]:mc.push(name),element.data("metroComponent",mc)}}catch(e){console.log(e.message,e.stack)}},reinitPlugin:function(element,name){this.destroyPlugin(element,name),this.initPlugin(element,name)},reinitPluginAll:function(element){var mc=$(element).data("metroComponent");void 0!==mc&&0<mc.length&&$.each(mc,function(){Metro.reinitPlugin(element,this)})},noop:function(){},noop_true:function(){return!0},noop_false:function(){return!1},stop:function(e){e.stopPropagation(),e.preventDefault()},requestFullScreen:function(element){element.mozRequestFullScreen?element.mozRequestFullScreen():element.webkitRequestFullScreen?element.webkitRequestFullScreen():element.msRequestFullscreen?element.msRequestFullscreen():element.requestFullscreen()},exitFullScreen:function(){document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.msExitFullscreen?document.msExitFullscreen():document.exitFullscreen()},inFullScreen:function(){return void 0!==(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement)},makeRuntime:function(el,role){var element=$(el);element.attr("data-role-"+role,!0);var mc=element.data("metroComponent");void 0===mc?mc=[role]:mc.push(role),element.data("metroComponent",mc)}};window.Metro=Metro,$(window).on(Metro.events.resize,function(){window.METRO_MEDIA=[],$.each(Metro.media_queries,function(key,query){Utils.media(query)&&METRO_MEDIA.push(Metro.media_mode[key])})}),$.fn.extend({toggleAttr:function(a,v){return this.each(function(){var el=$(this);void 0!==v?el.attr(a,v):void 0!==el.attr(a)?el.removeAttr(a):el.attr(a,""+a)})},clearClasses:function(){return this.each(function(){this.className=""})},fire:function(eventName,data){return this.each(function(){var e=document.createEvent("Events");e.detail=data,e.initEvent(eventName,!0,!1),this.dispatchEvent(e)})}}),Array.prototype.shuffle=function(){for(var temporaryValue,randomIndex,currentIndex=this.length;0!==currentIndex;)randomIndex=Math.floor(Math.random()*currentIndex),temporaryValue=this[currentIndex-=1],this[currentIndex]=this[randomIndex],this[randomIndex]=temporaryValue;return this},Array.prototype.clone=function(){return this.slice(0)},Array.prototype.unique=function(){for(var a=this.concat(),i=0;i<a.length;++i)for(var j=i+1;j<a.length;++j)a[i]===a[j]&&a.splice(j--,1);return a},Array.from||(Array.from=function(val){var i,a=[];if(void 0===val.length&&"object"==typeof val)return Object.values(val);if(void 0===val.length)throw new Error("Value can not be converted to array");for(i=0;i<val.length;i++)a.push(val[i]);return a}),"function"!=typeof Array.contains&&(Array.prototype.contains=function(val,from){return-1<this.indexOf(val,from)}),Number.prototype.format=function(n,x,s,c){var re="\\d(?=(\\d{"+(x||3)+"})+"+(0<n?"\\D":"$")+")",num=this.toFixed(Math.max(0,~~n));return(c?num.replace(".",c):num).replace(new RegExp(re,"g"),"$&"+(s||","))},String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1)},String.prototype.contains=function(){return!!~String.prototype.indexOf.apply(this,arguments)},String.prototype.toDate=function(format,locale){var normalized,formatItems,dateItems,monthIndex,dayIndex,yearIndex,hourIndex,minutesIndex,secondsIndex,year,month,day,hour,minute,second,parsedMonth;locale=locale||"en-US";if(null==format||""===format)return new Date(this);if(normalized=this.replace(/[\/,.:\s]/g,"-"),formatItems=format.toLowerCase().replace(/[^a-zA-Z0-9%]/g,"-").split("-"),dateItems=normalized.split("-"),""===normalized.replace(/\-/g,"").trim())return"Invalid Date";if(monthIndex=-1<formatItems.indexOf("mm")?formatItems.indexOf("mm"):formatItems.indexOf("%m"),dayIndex=-1<formatItems.indexOf("dd")?formatItems.indexOf("dd"):formatItems.indexOf("%d"),yearIndex=-1<formatItems.indexOf("yyyy")?formatItems.indexOf("yyyy"):-1<formatItems.indexOf("yy")?formatItems.indexOf("yy"):formatItems.indexOf("%y"),hourIndex=-1<formatItems.indexOf("hh")?formatItems.indexOf("hh"):formatItems.indexOf("%h"),minutesIndex=-1<formatItems.indexOf("ii")?formatItems.indexOf("ii"):-1<formatItems.indexOf("mi")?formatItems.indexOf("mi"):formatItems.indexOf("%i"),secondsIndex=-1<formatItems.indexOf("ss")?formatItems.indexOf("ss"):formatItems.indexOf("%s"),!(-1<monthIndex&&""!==dateItems[monthIndex]))return"Invalid Date";if(isNaN(parseInt(dateItems[monthIndex]))){if(dateItems[monthIndex]=function(month){var d,months,index,i;if(month=month.substr(0,3),void 0!==locale&&"en-US"!==locale&&void 0!==Locales&&void 0!==Locales[locale]&&void 0!==Locales[locale].calendar&&void 0!==Locales[locale].calendar.months){for(months=Locales[locale].calendar.months,i=12;i<months.length;i++)if(months[i].toLowerCase()===month.toLowerCase()){index=i-12;break}month=Locales["en-US"].calendar.months[index]}return d=Date.parse(month+" 1, 1972"),isNaN(d)?-1:new Date(d).getMonth()+1}(dateItems[monthIndex]),-1===dateItems[monthIndex])return"Invalid Date"}else if((parsedMonth=parseInt(dateItems[monthIndex]))<1||12<parsedMonth)return"Invalid Date";return year=-1<yearIndex&&""!==dateItems[yearIndex]?dateItems[yearIndex]:null,month=-1<monthIndex&&""!==dateItems[monthIndex]?dateItems[monthIndex]:null,day=-1<dayIndex&&""!==dateItems[dayIndex]?dateItems[dayIndex]:null,hour=-1<hourIndex&&""!==dateItems[hourIndex]?dateItems[hourIndex]:null,minute=-1<minutesIndex&&""!==dateItems[minutesIndex]?dateItems[minutesIndex]:null,second=-1<secondsIndex&&""!==dateItems[secondsIndex]?dateItems[secondsIndex]:null,new Date(year,month-1,day,hour,minute,second)},String.prototype.toArray=function(delimiter,type,format){return type=type||"string",format=null!=format&&format,(""+this).split(delimiter=delimiter||",").map(function(s){var result;switch(type){case"int":case"integer":result=parseInt(s);break;case"number":case"float":result=parseFloat(s);break;case"date":result=format?s.toDate(format):new Date(s);break;default:result=s.trim()}return result})},Date.prototype.getWeek=function(dowOffset){var nday,newYear,day,daynum,weeknum;return dowOffset=Utils.isValue(dowOffset)?"number"==typeof dowOffset?parseInt(dowOffset):0:METRO_WEEK_START,day=0<=(day=(newYear=new Date(this.getFullYear(),0,1)).getDay()-dowOffset)?day:day+7,daynum=Math.floor((this.getTime()-newYear.getTime()-6e4*(this.getTimezoneOffset()-newYear.getTimezoneOffset()))/864e5)+1,day<4?52<(weeknum=Math.floor((daynum+day-1)/7)+1)&&(weeknum=(nday=0<=(nday=new Date(this.getFullYear()+1,0,1).getDay()-dowOffset)?nday:nday+7)<4?1:53):weeknum=Math.floor((daynum+day-1)/7),weeknum},Date.prototype.getYear=function(){return this.getFullYear().toString().substr(-2)},Date.prototype.format=function(format,locale){void 0===locale&&(locale="en-US");var cal=(void 0!==Metro.locales&&void 0!==Metro.locales[locale]?Metro.locales[locale]:Metro.locales["en-US"]).calendar,date=this,nDay=date.getDay(),nDate=date.getDate(),nMonth=date.getMonth(),nYear=date.getFullYear(),nHour=date.getHours(),aDays=cal.days,aMonths=cal.months,aDayCount=[0,31,59,90,120,151,181,212,243,273,304,334],getThursday=function(){var target=new Date(date);return target.setDate(nDate-(nDay+6)%7+3),target},zeroPad=function(nNum,nPad){return(""+(Math.pow(10,nPad)+nNum)).slice(1)};return format.replace(/(%[a-z])/gi,function(sMatch){return{"%a":aDays[nDay].slice(0,3),"%A":aDays[nDay],"%b":aMonths[nMonth].slice(0,3),"%B":aMonths[nMonth],"%c":date.toUTCString(),"%C":Math.floor(nYear/100),"%d":zeroPad(nDate,2),dd:zeroPad(nDate,2),"%e":nDate,"%F":date.toISOString().slice(0,10),"%G":getThursday().getFullYear(),"%g":(""+getThursday().getFullYear()).slice(2),"%H":zeroPad(nHour,2),"%I":zeroPad((nHour+11)%12+1,2),"%j":zeroPad(aDayCount[nMonth]+nDate+(1<nMonth&&(nYear%4==0&&nYear%100!=0||nYear%400==0)?1:0),3),"%k":""+nHour,"%l":(nHour+11)%12+1,"%m":zeroPad(nMonth+1,2),"%M":zeroPad(date.getMinutes(),2),"%p":nHour<12?"AM":"PM","%P":nHour<12?"am":"pm","%s":Math.round(date.getTime()/1e3),"%S":zeroPad(date.getSeconds(),2),"%u":nDay||7,"%V":function(){var target=getThursday(),n1stThu=target.valueOf();target.setMonth(0,1);var nJan1=target.getDay();return 4!==nJan1&&target.setMonth(0,1+(4-nJan1+7)%7),zeroPad(1+Math.ceil((n1stThu-target)/6048e5),2)}(),"%w":""+nDay,"%x":date.toLocaleDateString(),"%X":date.toLocaleTimeString(),"%y":(""+nYear).slice(2),"%Y":nYear,"%z":date.toTimeString().replace(/.+GMT([+-]\d+).+/,"$1"),"%Z":date.toTimeString().replace(/.+\((.+?)\)$/,"$1")}[sMatch]||sMatch})},Date.prototype.addHours=function(n){return this.setTime(this.getTime()+60*n*60*1e3),this},Date.prototype.addDays=function(n){return this.setDate(this.getDate()+n),this},Date.prototype.addMonths=function(n){return this.setMonth(this.getMonth()+n),this},Date.prototype.addYears=function(n){return this.setFullYear(this.getFullYear()+n),this};var Utils={isUrl:function(val){return/^(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@\-\/]))?/.test(val)},isTag:function(val){return/^<\/?[\w\s="/.':;#-\/\?]+>/gi.test(val)},isColor:function(val){return/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(val)},isEmbedObject:function(val){var result=!1;return $.each(["iframe","object","embed","video"],function(i,v){"string"==typeof val&&val.toLowerCase()===v?result=!0:void 0!==val.nodeType&&val.tagName.toLowerCase()===v&&(result=!0)}),result},isVideoUrl:function(val){return/youtu\.be|youtube|vimeo/gi.test(val)},isDate:function(val,format){return!("object"!=typeof val||!Utils.isFunc(val.getMonth))||"Invalid Date"!==(Utils.isValue(format)?String(val).toDate(format):String(new Date(val)))},isDateObject:function(v){return"object"==typeof v&&void 0!==v.getMonth},isInt:function(n){return!isNaN(n)&&+n%1==0},isFloat:function(n){return!isNaN(n)&&+n%1!=0},isTouchDevice:function(){return"ontouchstart"in window||0<navigator.MaxTouchPoints||0<navigator.msMaxTouchPoints},isFunc:function(f){return Utils.isType(f,"function")},isObject:function(o){return Utils.isType(o,"object")},isArray:function(a){return Array.isArray(a)},isType:function(o,t){if(null==o)return!1;if(typeof o===t)return o;if(Utils.isTag(o)||Utils.isUrl(o))return!1;if(typeof window[o]===t)return window[o];if("string"==typeof o&&-1===o.indexOf("."))return!1;if("string"==typeof o&&-1!==o.indexOf(" "))return!1;if("string"==typeof o&&-1!==o.indexOf("("))return!1;if("string"==typeof o&&-1!==o.indexOf("["))return!1;if("number"==typeof o&&"number"!==t.toLowerCase())return!1;var i,ns=o.split("."),context=window;for(i=0;i<ns.length;i++)context=context[ns[i]];return typeof context===t&&context},isMetroObject:function(el,type){var $el=$(el),el_obj=$el.data(type);return 0===$el.length?(console.log(type+" "+el+" not found!"),!1):void 0!==el_obj||(console.log("Element not contain role "+type+'! Please add attribute data-role="'+type+'" to element '+el),!1)},isJQuery:function(el){return void 0!==jQuery&&el instanceof jQuery},isM4Q:function(el){return"undefined"!=typeof m4q&&el instanceof m4q},isQ:function(el){return Utils.isJQuery(el)||Utils.isM4Q(el)},embedObject:function(val){return"<div class='embed-container'>"+$(val)[0].outerHTML+"</div>"},embedUrl:function(val){return-1!==val.indexOf("youtu.be")&&(val="https://www.youtube.com/embed/"+val.split("/").pop()),"<div class='embed-container'><iframe src='"+val+"'></iframe></div>"},secondsToTime:function(secs){var divisor_for_minutes=secs%3600,divisor_for_seconds=divisor_for_minutes%60;return{h:Math.floor(secs/3600),m:Math.floor(divisor_for_minutes/60),s:Math.ceil(divisor_for_seconds)}},hex2rgba:function(hex,alpha){var c;if(alpha=isNaN(alpha)?1:alpha,/^#([A-Fa-f0-9]{3}){1,2}$/.test(hex))return 3===(c=hex.substring(1).split("")).length&&(c=[c[0],c[0],c[1],c[1],c[2],c[2]]),"rgba("+[(c="0x"+c.join(""))>>16&255,c>>8&255,255&c].join(",")+","+alpha+")";throw new Error("Hex2rgba error. Bad Hex value")},random:function(from,to){return Math.floor(Math.random()*(to-from+1)+from)},uniqueId:function(){var d=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(c){var r=(d+16*Math.random())%16|0;return d=Math.floor(d/16),("x"===c?r:3&r|8).toString(16)})},elementId:function(prefix){return prefix+"-"+(new Date).getTime()+Utils.random(1,1e3)},secondsToFormattedString:function(time){var sec_num=parseInt(time,10),hours=Math.floor(sec_num/3600),minutes=Math.floor((sec_num-3600*hours)/60),seconds=sec_num-3600*hours-60*minutes;return hours<10&&(hours="0"+hours),minutes<10&&(minutes="0"+minutes),seconds<10&&(seconds="0"+seconds),[hours,minutes,seconds].join(":")},callback:function(f,args,context){return Utils.exec(f,args,context)},func:function(f){return new Function("a",f)},exec:function(f,args,context){var result;if(null==f)return!1;var func=Utils.isFunc(f);!1===func&&(func=Utils.func(f));try{result=func.apply(context,args)}catch(err){if(!(result=null)===METRO_THROWS)throw err}return result},isOutsider:function(element){var rect,el=$(element),clone=el.clone();return clone.removeAttr("data-role").css({visibility:"hidden",position:"absolute",display:"block"}),el.parent().append(clone),rect=clone[0].getBoundingClientRect(),clone.remove(),0<=rect.top&&0<=rect.left&&rect.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&rect.right<=(window.innerWidth||document.documentElement.clientWidth)},inViewport:function(el){var rect=Utils.rect(el);return 0<=rect.top&&0<=rect.left&&rect.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&rect.right<=(window.innerWidth||document.documentElement.clientWidth)},rect:function(el){return"function"==typeof jQuery&&el instanceof jQuery&&(el=el[0]),el.getBoundingClientRect()},getCursorPosition:function(el,e){var a=Utils.rect(el);return{x:Utils.pageXY(e).x-a.left-window.pageXOffset,y:Utils.pageXY(e).y-a.top-window.pageYOffset}},getCursorPositionX:function(el,e){return Utils.getCursorPosition(el,e).x},getCursorPositionY:function(el,e){return Utils.getCursorPosition(el,e).y},objectLength:function(obj){return Object.keys(obj).length},percent:function(total,part,round_value){if(0===total)return 0;var result=100*part/total;return!0===round_value?Math.round(result):Math.round(100*result)/100},camelCase:function(str){return str.replace(/-([a-z])/g,function(g){return g[1].toUpperCase()})},dashedName:function(str){return str.replace(/([A-Z])/g,function(u){return"-"+u.toLowerCase()})},objectShift:function(obj){var min=0;return $.each(obj,function(i){0===min?min=i:i<min&&(min=i)}),delete obj[min],obj},objectDelete:function(obj,key){void 0!==obj[key]&&delete obj[key]},arrayDeleteByMultipleKeys:function(arr,keys){return keys.forEach(function(ind){delete arr[ind]}),arr.filter(function(item){return void 0!==item})},arrayDelete:function(arr,val){-1<arr.indexOf(val)&&arr.splice(arr.indexOf(val),1)},arrayDeleteByKey:function(arr,key){arr.splice(key,1)},nvl:function(data,other){return null==data?other:data},objectClone:function(obj){var copy={};for(var key in obj)obj.hasOwnProperty(key)&&(copy[key]=obj[key]);return copy},github:function(repo,callback){var that=this;$.ajax({url:"https://api.github.com/repos/"+repo,dataType:"jsonp"}).done(function(data){that.callback(callback,[data.data])})},detectIE:function(){var ua=window.navigator.userAgent,msie=ua.indexOf("MSIE ");if(0<msie)return parseInt(ua.substring(msie+5,ua.indexOf(".",msie)),10);if(0<ua.indexOf("Trident/")){var rv=ua.indexOf("rv:");return parseInt(ua.substring(rv+3,ua.indexOf(".",rv)),10)}var edge=ua.indexOf("Edge/");return 0<edge&&parseInt(ua.substring(edge+5,ua.indexOf(".",edge)),10)},detectChrome:function(){return/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)},md5:function(s){return hex_md5(s)},encodeURI:function(str){return encodeURI(str).replace(/%5B/g,"[").replace(/%5D/g,"]")},pageHeight:function(){var body=document.body,html=document.documentElement;return Math.max(body.scrollHeight,body.offsetHeight,html.clientHeight,html.scrollHeight,html.offsetHeight)},cleanPreCode:function(selector){Array.prototype.slice.call(document.querySelectorAll(selector),0).forEach(function(el){var txt=el.textContent.replace(/^[\r\n]+/,"").replace(/\s+$/g,"");if(/^\S/gm.test(txt))el.textContent=txt;else{for(var mat,str,len,re=/^[\t ]+/gm,min=1e3;mat=re.exec(txt);)(len=mat[0].length)<min&&(min=len,str=mat[0]);1e3!==min&&(el.textContent=txt.replace(new RegExp("^"+str,"gm"),""))}})},coords:function(element){var box=$(element)[0].getBoundingClientRect();return{top:box.top+window.pageYOffset,left:box.left+window.pageXOffset}},positionXY:function(e,t){switch(t){case"client":return Utils.clientXY(e);case"screen":return Utils.screenXY(e);case"page":return Utils.pageXY(e);default:return{x:0,y:0}}},clientXY:function(e){return{x:e.changedTouches?e.changedTouches[0].clientX:e.clientX,y:e.changedTouches?e.changedTouches[0].clientY:e.clientY}},screenXY:function(e){return{x:e.changedTouches?e.changedTouches[0].screenX:e.screenX,y:e.changedTouches?e.changedTouches[0].screenY:e.screenY}},pageXY:function(e){return{x:e.changedTouches?e.changedTouches[0].pageX:e.pageX,y:e.changedTouches?e.changedTouches[0].pageY:e.pageY}},isRightMouse:function(e){return"which"in e?3===e.which:"button"in e?2===e.button:void 0},hiddenElementSize:function(el,includeMargin){var clone=$(el).clone();clone.removeAttr("data-role").css({visibility:"hidden",position:"absolute",display:"block"}),$("body").append(clone),void 0===includeMargin&&(includeMargin=!1);var width=clone.outerWidth(includeMargin),height=clone.outerHeight(includeMargin);return clone.remove(),{width:width,height:height}},getStyle:function(element,pseudo){var el=$(element)[0];return window.getComputedStyle(el,pseudo)},getStyleOne:function(el,property){return Utils.getStyle(el).getPropertyValue(property)},getTransformMatrix:function(el,returnArray){var a=Utils.getStyleOne(el,"transform").replace("matrix(","").slice(0,-1).split(",");return!0!==returnArray?{a:a[0],b:a[1],c:a[2],d:a[3],tx:a[4],ty:a[5]}:a},computedRgbToHex:function(rgb){var i,a=rgb.replace(/[^\d,]/g,"").split(","),result="#";for(i=0;i<3;i++){var h=parseInt(a[i]).toString(16);result+=1===h.length?"0"+h:h}return result},computedRgbToRgba:function(rgb,alpha){var a=rgb.replace(/[^\d,]/g,"").split(",");return void 0===alpha&&(alpha=1),a.push(alpha),"rgba("+a.join(",")+")"},computedRgbToArray:function(rgb){return rgb.replace(/[^\d,]/g,"").split(",")},hexColorToArray:function(hex){var c;return/^#([A-Fa-f0-9]{3}){1,2}$/.test(hex)?(3===(c=hex.substring(1).split("")).length&&(c=[c[0],c[0],c[1],c[1],c[2],c[2]]),[(c="0x"+c.join(""))>>16&255,c>>8&255,255&c]):[0,0,0]},hexColorToRgbA:function(hex,alpha){var c;return/^#([A-Fa-f0-9]{3}){1,2}$/.test(hex)?(3===(c=hex.substring(1).split("")).length&&(c=[c[0],c[0],c[1],c[1],c[2],c[2]]),"rgba("+[(c="0x"+c.join(""))>>16&255,c>>8&255,255&c,alpha||1].join(",")+")"):"rgba(0,0,0,1)"},getInlineStyles:function(element){var i,l,styles={},el=$(element)[0];for(i=0,l=el.style.length;i<l;i++){var s=el.style[i];styles[s]=el.style[s]}return styles},updateURIParameter:function(uri,key,value){var re=new RegExp("([?&])"+key+"=.*?(&|$)","i"),separator=-1!==uri.indexOf("?")?"&":"?";return uri.match(re)?uri.replace(re,"$1"+key+"="+value+"$2"):uri+separator+key+"="+value},getURIParameter:function(url,name){url||(url=window.location.href),name=name.replace(/[\[\]]/g,"\\$&");var results=new RegExp("[?&]"+name+"(=([^&#]*)|&|#|$)").exec(url);return results?results[2]?decodeURIComponent(results[2].replace(/\+/g," ")):"":null},getLocales:function(){return Object.keys(Metro.locales)},addLocale:function(locale){Metro.locales=$.extend({},Metro.locales,locale)},strToArray:function(str,delimiter,type,format){return Utils.isValue(delimiter)||(delimiter=","),Utils.isValue(type)||(type="string"),(""+str).split(delimiter).map(function(s){var result;switch(type){case"int":case"integer":result=parseInt(s);break;case"number":case"float":result=parseFloat(s);break;case"date":result=Utils.isValue(format)?s.toDate(format):new Date(s);break;default:result=s.trim()}return result})},aspectRatioH:function(width,a){return"16/9"===a?9*width/16:"21/9"===a?9*width/21:"4/3"===a?3*width/4:void 0},aspectRatioW:function(height,a){return"16/9"===a?16*height/9:"21/9"===a?21*height/9:"4/3"===a?4*height/3:void 0},valueInObject:function(obj,value){return-1<Object.values(obj).indexOf(value)},keyInObject:function(obj,key){return-1<Object.keys(obj).indexOf(key)},inObject:function(obj,key,val){return void 0!==obj[key]&&obj[key]===val},newCssSheet:function(media){var style=document.createElement("style");return void 0!==media&&style.setAttribute("media",media),style.appendChild(document.createTextNode("")),document.head.appendChild(style),style.sheet},addCssRule:function(sheet,selector,rules,index){"insertRule"in sheet?sheet.insertRule(selector+"{"+rules+"}",index):"addRule"in sheet&&sheet.addRule(selector,rules,index)},media:function(query){return window.matchMedia(query).matches},mediaModes:function(){return METRO_MEDIA},mediaExist:function(media){return-1<METRO_MEDIA.indexOf(media)},inMedia:function(media){return-1<METRO_MEDIA.indexOf(media)&&METRO_MEDIA.indexOf(media)===METRO_MEDIA.length-1},isValue:function(val){return null!=val&&""!==val},isNull:function(val){return null==val},isNegative:function(val){return parseFloat(val)<0},isPositive:function(val){return 0<parseFloat(val)},isZero:function(val){return 0===parseFloat(val.toFixed(2))},between:function(val,bottom,top,equals){return!0===equals?bottom<=val&&val<=top:bottom<val&&val<top},parseMoney:function(val){return Number(parseFloat(val.replace(/[^0-9-.]/g,"")))},parseCard:function(val){return val.replace(/[^0-9]/g,"")},parsePhone:function(val){return Utils.parseCard(val)},isVisible:function(element){var el=$(element)[0];return"none"!==Utils.getStyleOne(el,"display")&&"hidden"!==Utils.getStyleOne(el,"visibility")&&null!==el.offsetParent},parseNumber:function(val,thousand,decimal){return val.replace(new RegExp("\\"+thousand,"g"),"").replace(new RegExp("\\"+decimal,"g"),".")},nearest:function(val,precision,down){return val/=precision,val=Math[!0===down?"floor":"ceil"](val)*precision},bool:function(value){switch(value){case!0:case"true":case 1:case"1":case"on":case"yes":return!0;default:return!1}},copy:function(element){var range,sel,body=document.body,el=$(element)[0];if(document.createRange&&window.getSelection){range=document.createRange(),(sel=window.getSelection()).removeAllRanges();try{range.selectNodeContents(el),sel.addRange(range)}catch(e){range.selectNode(el),sel.addRange(range)}}else body.createTextRange&&((range=body.createTextRange()).moveToElementText(el),range.select());document.execCommand("Copy"),window.getSelection?window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().removeAllRanges():document.selection&&document.selection.empty()},isLocalhost:function(){return"localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/)},formData:function(f){var i,j,form=$(f)[0],q={};if(form&&"FORM"===form.nodeName){for(i=form.elements.length-1;0<=i;i-=1)if(""!==form.elements[i].name)switch(form.elements[i].nodeName){case"INPUT":switch(form.elements[i].type){case"text":case"hidden":case"password":case"button":case"reset":case"submit":q[form.elements[i].name]=form.elements[i].value;break;case"checkbox":case"radio":form.elements[i].checked&&(q[form.elements[i].name]=form.elements[i].value)}break;case"file":break;case"TEXTAREA":q[form.elements[i].name]=form.elements[i].value;break;case"SELECT":switch(form.elements[i].type){case"select-one":q[form.elements[i].name]=form.elements[i].value;break;case"select-multiple":for(q[form.elements[i].name]=[],j=form.elements[i].options.length-1;0<=j;j-=1)form.elements[i].options[j].selected&&q[form.elements[i].name].push(form.elements[i].options[j].value)}break;case"BUTTON":switch(form.elements[i].type){case"reset":case"submit":case"button":q[form.elements[i].name]=form.elements[i].value}}return q}}};Metro.utils=Utils;var CalendarDefaultConfig={dayBorder:!1,excludeDay:null,prevMonthIcon:"<span class='default-icon-chevron-left'></span>",nextMonthIcon:"<span class='default-icon-chevron-right'></span>",prevYearIcon:"<span class='default-icon-chevron-left'></span>",nextYearIcon:"<span class='default-icon-chevron-right'></span>",compact:!1,wide:!1,widePoint:null,pickerMode:!1,show:null,locale:METRO_LOCALE,weekStart:METRO_WEEK_START,outside:!0,buttons:"cancel, today, clear, done",yearsBefore:100,yearsAfter:100,headerFormat:"%A, %b %e",showHeader:!0,showFooter:!0,showTimeField:!0,showWeekNumber:!1,clsCalendar:"",clsCalendarHeader:"",clsCalendarContent:"",clsCalendarFooter:"",clsCalendarMonths:"",clsCalendarYears:"",clsToday:"",clsSelected:"",clsExcluded:"",clsCancelButton:"",clsTodayButton:"",clsClearButton:"",clsDoneButton:"",isDialog:!1,ripple:!1,rippleColor:"#cccccc",exclude:null,preset:null,minDate:null,maxDate:null,weekDayClick:!1,weekNumberClick:!1,multiSelect:!1,special:null,format:METRO_DATE_FORMAT,inputFormat:null,onCancel:Metro.noop,onToday:Metro.noop,onClear:Metro.noop,onDone:Metro.noop,onDayClick:Metro.noop,onDayDraw:Metro.noop,onWeekDayClick:Metro.noop,onWeekNumberClick:Metro.noop,onMonthChange:Metro.noop,onYearChange:Metro.noop,onCalendarCreate:Metro.noop};Metro.calendarSetup=function(options){CalendarDefaultConfig=$.extend({},CalendarDefaultConfig,options)},void 0!==typeof window.metroCalendarSetup&&Metro.calendarSetup(window.metroCalendarSetup);var Calendar={init:function(options,elem){return this.options=$.extend({},CalendarDefaultConfig,options),this.elem=elem,this.element=$(elem),this.today=new Date,this.today.setHours(0,0,0,0),this.show=new Date,this.show.setHours(0,0,0,0),this.current={year:this.show.getFullYear(),month:this.show.getMonth(),day:this.show.getDate()},this.preset=[],this.selected=[],this.exclude=[],this.special=[],this.excludeDay=[],this.min=null,this.max=null,this.locale=null,this.minYear=this.current.year-this.options.yearsBefore,this.maxYear=this.current.year+this.options.yearsAfter,this.offset=(new Date).getTimezoneOffset()/60+1,this._setOptionsFromDOM(),this._create(),this},_setOptionsFromDOM:function(){var element=this.element,o=this.options;$.each(element.data(),function(key,value){if(key in o)try{o[key]=JSON.parse(value)}catch(e){o[key]=value}})},_create:function(){var element=this.element,o=this.options;element.html("").addClass("calendar "+(!0===o.compact?"compact":"")).addClass(o.clsCalendar),!0===o.dayBorder&&element.addClass("day-border"),Utils.isValue(o.excludeDay)&&(this.excludeDay=(""+o.excludeDay).toArray(",","int")),Utils.isValue(o.preset)&&this._dates2array(o.preset,"selected"),Utils.isValue(o.exclude)&&this._dates2array(o.exclude,"exclude"),Utils.isValue(o.special)&&this._dates2array(o.special,"special"),!1!==o.buttons&&!1===Array.isArray(o.buttons)&&(o.buttons=o.buttons.split(",").map(function(item){return item.trim()})),null!==o.minDate&&Utils.isDate(o.minDate,o.inputFormat)&&(this.min=Utils.isValue(o.inputFormat)?o.minDate.toDate(o.inputFormat):new Date(o.minDate)),null!==o.maxDate&&Utils.isDate(o.maxDate,o.inputFormat)&&(this.max=Utils.isValue(o.inputFormat)?o.maxDate.toDate(o.inputFormat):new Date(o.maxDate)),null!==o.show&&Utils.isDate(o.show,o.inputFormat)&&(this.show=Utils.isValue(o.inputFormat)?o.show.toDate(o.inputFormat):new Date(o.show),this.show.setHours(0,0,0,0),this.current={year:this.show.getFullYear(),month:this.show.getMonth(),day:this.show.getDate()}),this.locale=void 0!==Metro.locales[o.locale]?Metro.locales[o.locale]:Metro.locales["en-US"],this._drawCalendar(),this._createEvents(),!0===o.wide?element.addClass("calendar-wide"):!Utils.isNull(o.widePoint)&&Utils.mediaExist(o.widePoint)&&element.addClass("calendar-wide"),!0===o.ripple&&!1!==Utils.isFunc(element.ripple)&&element.ripple({rippleTarget:".button, .prev-month, .next-month, .prev-year, .next-year, .day",rippleColor:this.options.rippleColor}),Utils.exec(this.options.onCalendarCreate,[this.element]),element.fire("calendarcreate")},_dates2array:function(val,category){var dates,that=this,o=this.options;Utils.isNull(val)||(dates="string"==typeof val?Utils.strToArray(val):val,$.each(dates,function(){var _d;if(Utils.isDateObject(this))_d=this;else{if(_d=Utils.isValue(o.inputFormat)?this.toDate(o.inputFormat):new Date(this),!1===Utils.isDate(_d))return;_d.setHours(0,0,0,0)}that[category].push(_d.getTime())}))},_createEvents:function(){var that=this,element=this.element,o=this.options;$(window).on(Metro.events.resize,function(){!0!==o.wide&&(!Utils.isNull(o.widePoint)&&Utils.mediaExist(o.widePoint)?element.addClass("calendar-wide"):element.removeClass("calendar-wide"))}),element.on(Metro.events.click,".prev-month, .next-month, .prev-year, .next-year",function(e){var new_date,el=$(this);el.hasClass("prev-month")&&(new_date=new Date(that.current.year,that.current.month-1,1)).getFullYear()<that.minYear||el.hasClass("next-month")&&(new_date=new Date(that.current.year,that.current.month+1,1)).getFullYear()>that.maxYear||el.hasClass("prev-year")&&(new_date=new Date(that.current.year-1,that.current.month,1)).getFullYear()<that.minYear||el.hasClass("next-year")&&(new_date=new Date(that.current.year+1,that.current.month,1)).getFullYear()>that.maxYear||(that.current={year:new_date.getFullYear(),month:new_date.getMonth(),day:new_date.getDate()},setTimeout(function(){that._drawContent(),(el.hasClass("prev-month")||el.hasClass("next-month"))&&(Utils.exec(o.onMonthChange,[that.current,element],element[0]),element.fire("monthchange",{current:that.current})),(el.hasClass("prev-year")||el.hasClass("next-year"))&&(Utils.exec(o.onYearChange,[that.current,element],element[0]),element.fire("yearchange",{current:that.current}))},o.ripple?300:1),e.preventDefault(),e.stopPropagation())}),element.on(Metro.events.click,".button.today",function(e){that.toDay(),Utils.exec(o.onToday,[that.today,element]),element.fire("today",{today:that.today}),e.preventDefault(),e.stopPropagation()}),element.on(Metro.events.click,".button.clear",function(e){that.selected=[],that._drawContent(),Utils.exec(o.onClear,[element]),element.fire("clear"),e.preventDefault(),e.stopPropagation()}),element.on(Metro.events.click,".button.cancel",function(e){that._drawContent(),Utils.exec(o.onCancel,[element]),element.fire("cancel"),e.preventDefault(),e.stopPropagation()}),element.on(Metro.events.click,".button.done",function(e){that._drawContent(),Utils.exec(o.onDone,[that.selected,element]),element.fire("done"),e.preventDefault(),e.stopPropagation()}),!0===o.weekDayClick&&element.on(Metro.events.click,".week-days .day",function(e){var day,index,days;index=(day=$(this)).index(),!0===o.multiSelect&&(days=!0===o.outside?element.find(".days-row .day:nth-child("+(index+1)+")"):element.find(".days-row .day:not(.outside):nth-child("+(index+1)+")"),$.each(days,function(){var d=$(this),dd=d.data("day");d.hasClass("disabled")||d.hasClass("excluded")||(that.selected.contains(dd)||that.selected.push(dd),d.addClass("selected").addClass(o.clsSelected))})),Utils.exec(o.onWeekDayClick,[that.selected,day],element[0]),element.fire("weekdayclick",{day:day,selected:that.selected}),e.preventDefault(),e.stopPropagation()}),o.weekNumberClick&&element.on(Metro.events.click,".days-row .week-number",function(e){var weekNumElement,weekNumber,days;weekNumber=(weekNumElement=$(this)).text(),!0===o.multiSelect&&(days=$(this).siblings(".day"),$.each(days,function(){var d=$(this),dd=d.data("day");d.hasClass("disabled")||d.hasClass("excluded")||(that.selected.contains(dd)||that.selected.push(dd),d.addClass("selected").addClass(o.clsSelected))})),Utils.exec(o.onWeekNumberClick,[that.selected,weekNumber,weekNumElement],element[0]),element.fire("weeknumberclick",{el:this,num:weekNumber,selected:that.selected}),e.preventDefault(),e.stopPropagation()}),element.on(Metro.events.click,".days-row .day",function(e){var index,date,day=$(this);if(date=day.data("day"),index=that.selected.indexOf(date),day.hasClass("outside"))return date=new Date(date),that.current={year:date.getFullYear(),month:date.getMonth(),day:date.getDate()},void that._drawContent();day.hasClass("disabled")||(!0===o.pickerMode?(that.selected=[date],that.today=new Date(date),that.current.year=that.today.getFullYear(),that.current.month=that.today.getMonth(),that.current.day=that.today.getDate(),that._drawHeader(),that._drawContent()):-1===index?(!1===o.multiSelect&&(element.find(".days-row .day").removeClass("selected").removeClass(o.clsSelected),that.selected=[]),that.selected.push(date),day.addClass("selected").addClass(o.clsSelected)):(day.removeClass("selected").removeClass(o.clsSelected),Utils.arrayDelete(that.selected,date))),Utils.exec(o.onDayClick,[that.selected,day,element]),element.fire("dayclick",{day:day,selected:that.selected}),e.preventDefault(),e.stopPropagation()}),element.on(Metro.events.click,".curr-month",function(e){var target,list=element.find(".months-list");list.find(".active").removeClass("active"),list.scrollTop(0),element.find(".calendar-months").addClass("open"),target=list.find(".js-month-"+that.current.month).addClass("active"),setTimeout(function(){list.animate({scrollTop:target.position().top-(list.height()-target.height())/2},200)},300),e.preventDefault(),e.stopPropagation()}),element.on(Metro.events.click,".calendar-months li",function(e){that.current.month=$(this).index(),that._drawContent(),Utils.exec(o.onMonthChange,[that.current,element],element[0]),element.fire("monthchange",{current:that.current}),element.find(".calendar-months").removeClass("open"),e.preventDefault(),e.stopPropagation()}),element.on(Metro.events.click,".curr-year",function(e){var target,list=element.find(".years-list");list.find(".active").removeClass("active"),list.scrollTop(0),element.find(".calendar-years").addClass("open"),target=list.find(".js-year-"+that.current.year).addClass("active"),setTimeout(function(){list.animate({scrollTop:target.position().top-(list.height()-target.height())/2},200)},300),e.preventDefault(),e.stopPropagation()}),element.on(Metro.events.click,".calendar-years li",function(e){that.current.year=$(this).text(),that._drawContent(),Utils.exec(o.onYearChange,[that.current,element],element[0]),element.fire("yearchange",{current:that.current}),element.find(".calendar-years").removeClass("open"),e.preventDefault(),e.stopPropagation()}),element.on(Metro.events.click,function(e){var months=element.find(".calendar-months"),years=element.find(".calendar-years");months.hasClass("open")&&months.removeClass("open"),years.hasClass("open")&&years.removeClass("open"),e.preventDefault(),e.stopPropagation()})},_drawHeader:function(){var element=this.element,o=this.options,header=element.find(".calendar-header");0===header.length&&(header=$("<div>").addClass("calendar-header").addClass(o.clsCalendarHeader).appendTo(element)),header.html(""),$("<div>").addClass("header-year").html(this.today.getFullYear()).appendTo(header),$("<div>").addClass("header-day").html(this.today.format(o.headerFormat,o.locale)).appendTo(header),!1===o.showHeader&&header.hide()},_drawFooter:function(){var element=this.element,o=this.options,buttons_locale=this.locale.buttons,footer=element.find(".calendar-footer");!1!==o.buttons&&(0===footer.length&&(footer=$("<div>").addClass("calendar-footer").addClass(o.clsCalendarFooter).appendTo(element)),footer.html(""),$.each(o.buttons,function(){var button=$("<button>").attr("type","button").addClass("button "+this+" "+o["cls"+this.capitalize()+"Button"]).html(buttons_locale[this]).appendTo(footer);"cancel"!==this&&"done"!==this||button.addClass("js-dialog-close")}),!1===o.showFooter&&footer.hide())},_drawMonths:function(){var i,element=this.element,o=this.options,months=$("<div>").addClass("calendar-months").addClass(o.clsCalendarMonths).appendTo(element),list=$("<ul>").addClass("months-list").appendTo(months),calendar_locale=this.locale.calendar;for(i=0;i<12;i++)$("<li>").addClass("js-month-"+i).html(calendar_locale.months[i]).appendTo(list)},_drawYears:function(){var i,element=this.element,o=this.options,years=$("<div>").addClass("calendar-years").addClass(o.clsCalendarYears).appendTo(element),list=$("<ul>").addClass("years-list").appendTo(years);for(i=this.minYear;i<=this.maxYear;i++)$("<li>").addClass("js-year-"+i).html(i).appendTo(list)},_drawContent:function(){var toolbar,i,j,d,s,first_day,year,month,element=this.element,o=this.options,content=element.find(".calendar-content"),calendar_locale=this.locale.calendar,counter=0,first=new Date(this.current.year,this.current.month,1),prev_month_days=new Date(this.current.year,this.current.month,0).getDate();0===content.length&&(content=$("<div>").addClass("calendar-content").addClass(o.clsCalendarContent).appendTo(element)),content.html(""),toolbar=$("<div>").addClass("calendar-toolbar").appendTo(content),$("<span>").addClass("prev-month").html(o.prevMonthIcon).appendTo(toolbar),$("<span>").addClass("curr-month").html(calendar_locale.months[this.current.month]).appendTo(toolbar),$("<span>").addClass("next-month").html(o.nextMonthIcon).appendTo(toolbar),$("<span>").addClass("prev-year").html(o.prevYearIcon).appendTo(toolbar),$("<span>").addClass("curr-year").html(this.current.year).appendTo(toolbar),$("<span>").addClass("next-year").html(o.nextYearIcon).appendTo(toolbar);var week_days=$("<div>").addClass("week-days").appendTo(content),day_class="day";for(!0===o.showWeekNumber&&($("<span>").addClass("week-number").html("#").appendTo(week_days),day_class+=" and-week-number"),i=0;i<7;i++)0===o.weekStart?j=i:7===(j=i+1)&&(j=0),$("<span>").addClass(day_class).html(calendar_locale.days[j+7]).appendTo(week_days);var days=$("<div>").addClass("days").appendTo(content),days_row=$("<div>").addClass("days-row").appendTo(days);for(first_day=0===o.weekStart?first.getDay():0===first.getDay()?6:first.getDay()-1,year=this.current.month-1<0?(month=11,this.current.year-1):(month=this.current.month-1,this.current.year),!0===o.showWeekNumber&&$("<div>").addClass("week-number").html(new Date(year,month,prev_month_days-first_day+1).getWeek(o.weekStart)).appendTo(days_row),i=0;i<first_day;i++){var v=prev_month_days-first_day+i+1;d=$("<div>").addClass(day_class+" outside").appendTo(days_row),(s=new Date(year,month,v)).setHours(0,0,0,0),d.data("day",s.getTime()),!0===o.outside&&(d.html(v),0<this.excludeDay.length&&-1<this.excludeDay.indexOf(s.getDay())&&d.addClass("disabled excluded").addClass(o.clsExcluded),Utils.exec(o.onDayDraw,[s],d[0]),element.fire("daydraw",{cell:d[0],date:s})),counter++}for(first.setHours(0,0,0,0);first.getMonth()===this.current.month;)(d=$("<div>").addClass(day_class).html(first.getDate()).appendTo(days_row)).data("day",first.getTime()),this.show.getTime()===first.getTime()&&d.addClass("showed"),this.today.getTime()===first.getTime()&&d.addClass("today").addClass(o.clsToday),0===this.special.length?(-1!==this.selected.indexOf(first.getTime())&&d.addClass("selected").addClass(o.clsSelected),-1!==this.exclude.indexOf(first.getTime())&&d.addClass("disabled excluded").addClass(o.clsExcluded),null!==this.min&&first.getTime()<this.min.getTime()&&d.addClass("disabled excluded").addClass(o.clsExcluded),null!==this.max&&first.getTime()>this.max.getTime()&&d.addClass("disabled excluded").addClass(o.clsExcluded),0<this.excludeDay.length&&-1<this.excludeDay.indexOf(first.getDay())&&d.addClass("disabled excluded").addClass(o.clsExcluded)):-1===this.special.indexOf(first.getTime())&&d.addClass("disabled excluded").addClass(o.clsExcluded),Utils.exec(o.onDayDraw,[first],d[0]),element.fire("daydraw",{cell:d[0],date:first}),++counter%7==0&&(days_row=$("<div>").addClass("days-row").appendTo(days),!0===o.showWeekNumber&&$("<div>").addClass("week-number").html(new Date(first.getFullYear(),first.getMonth(),first.getDate()+1).getWeek(o.weekStart)).appendTo(days_row)),first.setDate(first.getDate()+1),first.setHours(0,0,0,0);if(first_day=0===o.weekStart?first.getDay():0===first.getDay()?6:first.getDay()-1,year=11<this.current.month+1?(month=0,this.current.year+1):(month=this.current.month+1,this.current.year),0<first_day)for(i=0;i<7-first_day;i++)d=$("<div>").addClass(day_class+" outside").appendTo(days_row),(s=new Date(year,month,i+1)).setHours(0,0,0,0),d.data("day",s.getTime()),!0===o.outside&&(d.html(i+1),0<this.excludeDay.length&&-1<this.excludeDay.indexOf(s.getDay())&&d.addClass("disabled excluded").addClass(o.clsExcluded),Utils.exec(o.onDayDraw,[s],d[0]),element.fire("daydraw",{cell:d[0],date:s}))},_drawCalendar:function(){var that=this;setTimeout(function(){that.element.html(""),that._drawHeader(),that._drawContent(),that._drawFooter(),that._drawMonths(),that._drawYears()},0)},getPreset:function(){return this.preset},getSelected:function(){return this.selected},getExcluded:function(){return this.exclude},getToday:function(){return this.today},getCurrent:function(){return this.current},clearSelected:function(){this.selected=[],this._drawContent()},toDay:function(){this.today=new Date,this.today.setHours(0,0,0,0),this.current={year:this.today.getFullYear(),month:this.today.getMonth(),day:this.today.getDate()},this._drawHeader(),this._drawContent()},setExclude:function(exclude){var element=this.element,o=this.options;Utils.isNull(exclude)&&Utils.isNull(element.attr("data-exclude"))||(o.exclude=Utils.isNull(exclude)?element.attr("data-exclude"):exclude,this._dates2array(o.exclude,"exclude"),this._drawContent())},setPreset:function(preset){var element=this.element,o=this.options;Utils.isNull(preset)&&Utils.isNull(element.attr("data-preset"))||(o.preset=Utils.isNull(preset)?element.attr("data-preset"):preset,this._dates2array(o.preset,"selected"),this._drawContent())},setSpecial:function(special){var element=this.element,o=this.options;Utils.isNull(special)&&Utils.isNull(element.attr("data-special"))||(o.special=Utils.isNull(special)?element.attr("data-special"):special,this._dates2array(o.exclude,"special"),this._drawContent())},setShow:function(show){var element=this.element,o=this.options;Utils.isNull(show)&&Utils.isNull(element.attr("data-show"))||(o.show=Utils.isNull(show)?element.attr("data-show"):show,this.show=Utils.isDateObject(show)?show:Utils.isValue(o.inputFormat)?o.show.toDate(o.inputFormat):new Date(o.show),this.show.setHours(0,0,0,0),this.current={year:this.show.getFullYear(),month:this.show.getMonth(),day:this.show.getDate()},this._drawContent())},setMinDate:function(date){var element=this.element,o=this.options;o.minDate=Utils.isValue(date)?date:element.attr("data-min-date"),Utils.isValue(o.minDate)&&Utils.isDate(o.minDate,o.inputFormat)&&(this.min=Utils.isValue(o.inputFormat)?o.minDate.toDate(o.inputFormat):new Date(o.minDate)),this._drawContent()},setMaxDate:function(date){var element=this.element,o=this.options;o.maxDate=Utils.isValue(date)?date:element.attr("data-max-date"),Utils.isValue(o.maxDate)&&Utils.isDate(o.maxDate,o.inputFormat)&&(this.max=Utils.isValue(o.inputFormat)?o.maxDate.toDate(o.inputFormat):new Date(o.maxDate)),this._drawContent()},setToday:function(val){this.element;var o=this.options;Utils.isValue(val)||(val=new Date),this.today=Utils.isDateObject(val)?val:Utils.isValue(o.inputFormat)?val.toDate(o.inputFormat):new Date(val),this.today.setHours(0,0,0,0),this._drawHeader(),this._drawContent()},i18n:function(val){this.element;var o=this.options;return void 0===val?o.locale:void 0!==Metro.locales[val]&&(o.locale=val,this.locale=Metro.locales[o.locale],void this._drawCalendar())},changeAttrLocale:function(){var element=this.element;this.options;this.i18n(element.attr("data-locale"))},changeAttribute:function(attributeName){switch(attributeName){case"data-exclude":this.setExclude();break;case"data-preset":this.setPreset();break;case"data-special":this.setSpecial();break;case"data-show":this.setShow();break;case"data-min-date":this.setMinDate();break;case"data-max-date":this.setMaxDate();break;case"data-locale":this.changeAttrLocale()}},destroy:function(){var element=this.element,o=this.options;element.off(Metro.events.click,".prev-month, .next-month, .prev-year, .next-year"),element.off(Metro.events.click,".button.today"),element.off(Metro.events.click,".button.clear"),element.off(Metro.events.click,".button.cancel"),element.off(Metro.events.click,".button.done"),element.off(Metro.events.click,".week-days .day"),element.off(Metro.events.click,".days-row .day"),element.off(Metro.events.click,".curr-month"),element.off(Metro.events.click,".calendar-months li"),element.off(Metro.events.click,".curr-year"),element.off(Metro.events.click,".calendar-years li"),element.off(Metro.events.click),!0===o.ripple&&Metro.destroyPlugin(element,"ripple"),element.html("")}};$(document).on(Metro.events.click,function(e){$(".calendar .calendar-years").each(function(){$(this).removeClass("open")}),$(".calendar .calendar-months").each(function(){$(this).removeClass("open")})}),Metro.plugin("calendar",Calendar);var Locales={"en-US":{calendar:{months:["January","February","March","April","May","June","July","August","September","October","November","December","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Su","Mo","Tu","We","Th","Fr","Sa","Sun","Mon","Tus","Wen","Thu","Fri","Sat"],time:{days:"DAYS",hours:"HOURS",minutes:"MINS",seconds:"SECS",month:"MON",day:"DAY",year:"YEAR"}},buttons:{ok:"OK",cancel:"Cancel",done:"Done",today:"Today",now:"Now",clear:"Clear",help:"Help",yes:"Yes",no:"No",random:"Random",save:"Save",reset:"Reset"}},"cn-ZH":{calendar:{months:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月","1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],days:["星期日","星期一","星期二","星期三","星期四","星期五","星期六","日","一","二","三","四","五","六","周日","周一","周二","周三","周四","周五","周六"],time:{days:"天",hours:"时",minutes:"分",seconds:"秒",month:"月",day:"日",year:"年"}},buttons:{ok:"确认",cancel:"取消",done:"完成",today:"今天",now:"现在",clear:"清除",help:"帮助",yes:"是",no:"否",random:"随机",save:"保存",reset:"重啟"}},"de-DE":{calendar:{months:["Januar","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember","Jan","Feb","Mär","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"],days:["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag","Sn","Mn","Di","Mi","Do","Fr","Sa","Son","Mon","Die","Mit","Don","Fre","Sam"],time:{days:"TAGE",hours:"UHR",minutes:"MIN",seconds:"SEK"}},buttons:{ok:"OK",cancel:"Abbrechen",done:"Fertig",today:"Heute",now:"Jetzt",clear:"Reinigen",help:"Hilfe",yes:"Ja",no:"Nein",random:"Zufällig",save:"Sparen",reset:"Zurücksetzen"}},"hu-HU":{calendar:{months:["Január","Február","Március","Április","Május","Június","Július","Augusztus","Szeptember","Október","November","December","Jan","Feb","Már","Ápr","Máj","Jún","Júl","Aug","Szep","Okt","Nov","Dec"],days:["Vasárnap","Hétfő","Kedd","Szerda","Csütörtök","Péntek","Szombat","V","H","K","Sz","Cs","P","Sz","Vas","Hét","Ke","Sze","Csü","Pén","Szom"],time:{days:"NAP",hours:"ÓRA",minutes:"PERC",seconds:"MP"}},buttons:{ok:"OK",cancel:"Mégse",done:"Kész",today:"Ma",now:"Most",clear:"Törlés",help:"Segítség",yes:"Igen",no:"Nem",random:"Véletlen",save:"Mentés",reset:"Visszaállítás"}},"ru-RU":{calendar:{months:["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь","Янв","Фев","Мар","Апр","Май","Июн","Июл","Авг","Сен","Окт","Ноя","Дек"],days:["Воскресенье","Понедельник","Вторник","Среда","Четверг","Пятница","Суббота","Вс","Пн","Вт","Ср","Чт","Пт","Сб","Вос","Пон","Вто","Сре","Чет","Пят","Суб"],time:{days:"ДНИ",hours:"ЧАСЫ",minutes:"МИН",seconds:"СЕК"}},buttons:{ok:"ОК",cancel:"Отмена",done:"Готово",today:"Сегодня",now:"Сейчас",clear:"Очистить",help:"Помощь",yes:"Да",no:"Нет",random:"Случайно",save:"Сохранить",reset:"Сброс"}},"uk-UA":{calendar:{months:["Січень","Лютий","Березень","Квітень","Травень","Червень","Липень","Серпень","Вересень","Жовтень","Листопад","Грудень","Січ","Лют","Бер","Кві","Тра","Чер","Лип","Сер","Вер","Жов","Лис","Гру"],days:["Неділя","Понеділок","Вівторок","Середа","Четвер","П’ятниця","Субота","Нд","Пн","Вт","Ср","Чт","Пт","Сб","Нед","Пон","Вiв","Сер","Чет","Пят","Суб"],time:{days:"ДНІ",hours:"ГОД",minutes:"ХВИЛ",seconds:"СЕК"}},buttons:{ok:"ОК",cancel:"Відміна",done:"Готово",today:"Сьогодні",now:"Зараз",clear:"Очистити",help:"Допомога",yes:"Так",no:"Ні",random:"Випадково",save:"Зберегти",reset:"Скинути"}},"es-MX":{calendar:{months:["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre","Ene","Feb","Mar","Abr","May","Jun","Jul","Ago","Sep","Oct","Nov","Dic"],days:["Domingo","Lunes","Martes","Miércoles","Jueves","Viernes","Sábado","Do","Lu","Ma","Mi","Ju","Vi","Sa","Dom","Lun","Mar","Mié","Jue","Vie","Sáb"],time:{days:"DÍAS",hours:"HORAS",minutes:"MINS",seconds:"SEGS",month:"MES",day:"DÍA",year:"AÑO"}},buttons:{ok:"Aceptar",cancel:"Cancelar",done:"Hecho",today:"Hoy",now:"Ahora",clear:"Limpiar",help:"Ayuda",yes:"Si",no:"No",random:"Aleatorio",save:"Salvar",reset:"Reiniciar"}},"fr-FR":{calendar:{months:["Janvier","Février","Mars","Avril","Mai","Juin","Juillet","Août","Septembre","Octobre","Novembre","Décembre","Janv","Févr","Mars","Avr","Mai","Juin","Juil","Août","Sept","Oct","Nov","Déc"],days:["Dimanche","Lundi","Mardi","Mercredi","Jeudi","Vendredi","Samedi","De","Du","Ma","Me","Je","Ve","Sa","Dim","Lun","Mar","Mer","Jeu","Ven","Sam"],time:{days:"JOURS",hours:"HEURES",minutes:"MINS",seconds:"SECS",month:"MOIS",day:"JOUR",year:"ANNEE"}},buttons:{ok:"OK",cancel:"Annulé",done:"Fait",today:"Aujourd'hui",now:"Maintenant",clear:"Effacé",help:"Aide",yes:"Oui",no:"Non",random:"Aléatoire",save:"Sauvegarder",reset:"Réinitialiser"}},"it-IT":{calendar:{months:["Gennaio","Febbraio","Marzo","Aprile","Maggio","Giugno","Luglio","Agosto","Settembre","Ottobre","Novembre","Dicembre","Gen","Feb","Mar","Apr","Mag","Giu","Lug","Ago","Set","Ott","Nov","Dic"],days:["Domenica","Lunedì","Martedì","Mercoledì","Giovedì","Venerdì","Sabato","Do","Lu","Ma","Me","Gi","Ve","Sa","Dom","Lun","Mar","Mer","Gio","Ven","Sab"],time:{days:"GIORNI",hours:"ORE",minutes:"MIN",seconds:"SEC",month:"MESE",day:"GIORNO",year:"ANNO"}},buttons:{ok:"OK",cancel:"Annulla",done:"Fatto",today:"Oggi",now:"Adesso",clear:"Cancella",help:"Aiuto",yes:"Sì",no:"No",random:"Random",save:"Salvare",reset:"Reset"}}};Metro.locales=Locales;var CalendarPickerDefaultConfig={nullValue:!0,prepend:"",calendarWide:!1,calendarWidePoint:null,dialogMode:!1,dialogPoint:360,dialogOverlay:!0,overlayColor:"#000000",overlayAlpha:.5,locale:METRO_LOCALE,size:"100%",format:METRO_DATE_FORMAT,inputFormat:null,headerFormat:"%A, %b %e",clearButton:!1,calendarButtonIcon:"<span class='default-icon-calendar'></span>",clearButtonIcon:"<span class='default-icon-cross'></span>",copyInlineStyles:!1,clsPicker:"",clsInput:"",yearsBefore:100,yearsAfter:100,weekStart:METRO_WEEK_START,outside:!0,ripple:!1,rippleColor:"#cccccc",exclude:null,minDate:null,maxDate:null,special:null,showHeader:!0,clsCalendar:"",clsCalendarHeader:"",clsCalendarContent:"",clsCalendarMonths:"",clsCalendarYears:"",clsToday:"",clsSelected:"",clsExcluded:"",onDayClick:Metro.noop,onCalendarPickerCreate:Metro.noop,onCalendarShow:Metro.noop,onCalendarHide:Metro.noop,onChange:Metro.noop,onMonthChange:Metro.noop,onYearChange:Metro.noop};Metro.calendarPickerSetup=function(options){CalendarPickerDefaultConfig=$.extend({},CalendarPickerDefaultConfig,options)},void 0!==typeof window.metroCalendarPickerSetup&&Metro.calendarPickerSetup(window.metroCalendarPickerSetup);var CalendarPicker={init:function(options,elem){return this.options=$.extend({},CalendarPickerDefaultConfig,options),this.elem=elem,this.element=$(elem),this.value=null,this.value_date=null,this.calendar=null,this.overlay=null,this._setOptionsFromDOM(),this._create(),Utils.exec(this.options.onCalendarPickerCreate,[this.element],this.elem),$(elem).fire("calendarpickercreate"),this},dependencies:["calendar"],_setOptionsFromDOM:function(){var element=this.element,o=this.options;$.each(element.data(),function(key,value){if(key in o)try{o[key]=JSON.parse(value)}catch(e){o[key]=value}})},_create:function(){this._createStructure(),this._createEvents()},_createStructure:function(){var that=this,element=this.element,o=this.options,prev=element.prev(),parent=element.parent(),container=$("<div>").addClass("input "+element[0].className+" calendar-picker"),buttons=$("<div>").addClass("button-group"),cal=$("<div>").addClass("drop-shadow"),curr=element.val().trim();(void 0===element.attr("type")&&element.attr("type","text"),Utils.isValue(curr)&&(this.value=!1===Utils.isValue(o.inputFormat)?new Date(curr):curr.toDate(o.inputFormat,o.locale)),Utils.isValue(this.value)&&this.value.setHours(0,0,0,0),element.val(Utils.isValue(curr)||!0!==o.nullValue?this.value.format(o.format):""),0===prev.length?parent.prepend(container):container.insertAfter(prev),element.appendTo(container),buttons.appendTo(container),cal.appendTo(container),cal.calendar({wide:o.calendarWide,widePoint:o.calendarWidePoint,format:o.format,inputFormat:o.inputFormat,pickerMode:!0,show:o.value,locale:o.locale,weekStart:o.weekStart,outside:o.outside,buttons:!1,headerFormat:o.headerFormat,clsCalendar:o.clsCalendar,clsCalendarHeader:o.clsCalendarHeader,clsCalendarContent:o.clsCalendarContent,clsCalendarFooter:"d-none",clsCalendarMonths:o.clsCalendarMonths,clsCalendarYears:o.clsCalendarYears,clsToday:o.clsToday,clsSelected:o.clsSelected,clsExcluded:o.clsExcluded,ripple:o.ripple,rippleColor:o.rippleColor,exclude:o.exclude,minDate:o.minDate,maxDate:o.maxDate,yearsBefore:o.yearsBefore,yearsAfter:o.yearsAfter,special:o.special,showHeader:o.showHeader,showFooter:!1,onDayClick:function(sel,day,el){var date=new Date(sel[0]);date.setHours(0,0,0,0),that._removeOverlay(),that.value=date,element.val(date.format(o.format,o.locale)),element.trigger("change"),cal.removeClass("open open-up"),cal.hide(),Utils.exec(o.onChange,[that.value],element[0]),element.fire("change",{val:that.value}),Utils.exec(o.onDayClick,[sel,day,el],element[0]),element.fire("dayclick",{sel:sel,day:day,el:el})},onMonthChange:o.onMonthChange,onYearChange:o.onYearChange}),this.calendar=cal,!0===o.clearButton&&$("<button>").addClass("button input-clear-button").attr("tabindex",-1).attr("type","button").html(o.clearButtonIcon).appendTo(buttons),$("<button>").addClass("button").attr("tabindex",-1).attr("type","button").html(o.calendarButtonIcon).appendTo(buttons),""!==o.prepend)&&$("<div>").html(o.prepend).addClass("prepend").addClass(o.clsPrepend).appendTo(container);"rtl"===element.attr("dir")&&container.addClass("rtl"),-1<String(o.size).indexOf("%")?container.css({width:o.size}):container.css({width:parseInt(o.size)+"px"}),element[0].className="",element.attr("readonly",!0),!0===o.copyInlineStyles&&$.each(Utils.getInlineStyles(element),function(key,value){container.css(key,value)}),container.addClass(o.clsPicker),element.addClass(o.clsInput),!0===o.dialogOverlay&&(this.overlay=that._overlay()),!0===o.dialogMode?container.addClass("dialog-mode"):Utils.media("(max-width: "+o.dialogPoint+"px)")&&container.addClass("dialog-mode"),element.is(":disabled")?this.disable():this.enable()},_createEvents:function(){var that=this,element=this.element,o=this.options,container=element.parent(),clear=container.find(".input-clear-button"),cal=this.calendar,cal_plugin=cal.data("calendar");$(window).on(Metro.events.resize,function(){!0!==o.dialogMode&&(Utils.media("(max-width: "+o.dialogPoint+"px)")?container.addClass("dialog-mode"):container.removeClass("dialog-mode"))}),0<clear.length&&clear.on(Metro.events.click,function(e){element.val("").trigger("change").blur(),that.value=null,e.preventDefault(),e.stopPropagation()}),container.on(Metro.events.click,"button, input",function(e){var value=Utils.isValue(that.value)?that.value:new Date;value.setHours(0,0,0,0),!1===cal.hasClass("open")&&!1===cal.hasClass("open-up")?($(".calendar-picker .calendar").removeClass("open open-up").hide(),cal_plugin.setPreset([value]),cal_plugin.setShow(value),cal_plugin.setToday(value),container.hasClass("dialog-mode")&&that.overlay.appendTo($("body")),cal.addClass("open"),!1===Utils.isOutsider(cal)&&cal.addClass("open-up"),Utils.exec(o.onCalendarShow,[element,cal],cal),element.fire("calendarshow",{calendar:cal})):(that._removeOverlay(),cal.removeClass("open open-up"),Utils.exec(o.onCalendarHide,[element,cal],cal),element.fire("calendarhide",{calendar:cal})),e.preventDefault(),e.stopPropagation()}),element.on(Metro.events.blur,function(){container.removeClass("focused")}),element.on(Metro.events.focus,function(){container.addClass("focused")}),element.on(Metro.events.change,function(){Utils.exec(o.onChange,[that.value],element[0])})},_overlay:function(){var o=this.options,overlay=$("<div>");return overlay.addClass("overlay for-calendar-picker").addClass(o.clsOverlay),"transparent"===o.overlayColor?overlay.addClass("transparent"):overlay.css({background:Utils.hex2rgba(o.overlayColor,o.overlayAlpha)}),overlay},_removeOverlay:function(){$("body").find(".overlay.for-calendar-picker").remove()},val:function(v){var element=this.element,o=this.options;if(Utils.isNull(v))return this.value;!0===Utils.isDate(v,o.inputFormat)&&(this.calendar.data("calendar").clearSelected(),this.value="string"==typeof v?v.toDate(o.inputFormat):v,element.val(this.value.format(o.format)),element.trigger("change"))},disable:function(){this.element.data("disabled",!0),this.element.parent().addClass("disabled")},enable:function(){this.element.data("disabled",!1),this.element.parent().removeClass("disabled")},toggleState:function(){this.elem.disabled?this.disable():this.enable()},i18n:function(val){var hidden,o=this.options,cal=this.calendar;return void 0===val?o.locale:void 0!==Metro.locales[val]&&((hidden=cal.is(":hidden"))&&cal.css({visibility:"hidden",display:"block"}),cal.data("calendar").i18n(val),void(hidden&&cal.css({visibility:"visible",display:"none"})))},changeAttribute:function(attributeName){var that=this,element=this.element,cal=(this.options,this.calendar.data("calendar"));switch(attributeName){case"value":that.val(element.attr("value"));break;case"disabled":this.toggleState();break;case"data-locale":that.i18n(element.attr("data-locale"));break;case"data-special":cal.setSpecial(element.attr("data-special"));break;case"data-exclude":cal.setExclude(element.attr("data-exclude"));break;case"data-min-date":cal.setMinDate(element.attr("data-min-date"));break;case"data-max-date":cal.setMaxDate(element.attr("data-max-date"))}}};return Metro.plugin("calendarpicker",CalendarPicker),$(document).on(Metro.events.click,".overlay.for-calendar-picker",function(){$(this).remove()}),$(document).on(Metro.events.click,function(){$(".calendar-picker .calendar").removeClass("open open-up")}),!0===METRO_INIT?Metro.init():Metro});